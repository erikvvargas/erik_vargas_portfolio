[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Tidy Tuesday",
    "section": "",
    "text": "Introduction\nThis Bookdown repository serves as a place to store my TidyTuesday submissions and showcase the code and deeper analysis on each dataset. As I continue to analyze the weekly datasets I’ll upload the code here and link to the new page in my social media posts. Thanks for reading!"
  },
  {
    "objectID": "week_11-28-2023.html#preliminaries",
    "href": "week_11-28-2023.html#preliminaries",
    "title": "1  Week of 11/28/2023",
    "section": "1.1 Preliminaries",
    "text": "1.1 Preliminaries\nLoading up some libraries that will make this analysis easier, namely tidyverse and lubridate. Also, we’ll load the data from the tidytuesdayR package.\n\nlibrary(tidyverse)\nlibrary(viridis)\nlibrary(hrbrthemes)\nlibrary(ggridges)\nlibrary(lubridate)\n\n\n# tuesdata <- tidytuesdayR::tt_load('2023-11-28')\n\n# drwho_episodes <- tuesdata$drwho_episodes\n# drwho_directors <- tuesdata$drwho_directors\n# drwho_writers <- tuesdata$drwho_writers\nsetwd(\"data\")\ndrwho_episodes <- read_csv(\"drwho_episodes.csv\")\ndrwho_directors <- read_csv(\"drwho_directors.csv\")\ndrwho_writers <- read_csv(\"drwho_writers.csv\")"
  },
  {
    "objectID": "week_11-28-2023.html#data-cleaning",
    "href": "week_11-28-2023.html#data-cleaning",
    "title": "1  Week of 11/28/2023",
    "section": "1.2 Data Cleaning",
    "text": "1.2 Data Cleaning\nFirst we join the data together in one flat table, then create a year variable for each episode based on when it was aired. We also turn the year variable into a factor so that it will be plotted correctly later on.\n\n# join all data together\n\ndrwho_episodes <- left_join(drwho_episodes, drwho_directors, \n                            by = \"story_number\")\n\ndrwho_episodes <- left_join(drwho_episodes, drwho_writers, \n                            by = \"story_number\")\n\n# get a year aired variable for each episode\ndrwho_episodes <- drwho_episodes %>% \n  mutate(year_aired = floor_date(first_aired, \"year\"))\n\n# strip out the month and day\ndrwho_episodes$year_aired <- year(drwho_episodes$year_aired)\n\ndrwho_episodes$year_aired <- as.factor(drwho_episodes$year_aired)"
  },
  {
    "objectID": "week_11-28-2023.html#ridgeline-plot",
    "href": "week_11-28-2023.html#ridgeline-plot",
    "title": "1  Week of 11/28/2023",
    "section": "1.3 Ridgeline Plot",
    "text": "1.3 Ridgeline Plot\nFinally, we visualize the Dr. Who episode ratings by year the episodes were aired. An apparent decline in ratings can be seen as the show has progressed through 2022.\n\ndrwho_episodes %>% \n  group_by(year_aired) %>% \n  ggplot(aes(x = rating, y = year_aired, group = year_aired,\n           fill = ..x..)) +\n  geom_density_ridges_gradient(scale = 3, rel_min_height = 0.01) +\n  scale_fill_viridis(name = \"Rating\", option = \"D\") +\n  labs(title = 'Ratings of Dr. Who Episodes by Year',\n       x = \"Rating\",\n       y = \"Year Episode Aired\") +\n  theme(\n    panel.spacing = unit(0.1, \"lines\"),\n    strip.text.x = element_text(size = 8),\n    axis.title.x = element_text(size = 15),\n    axis.title.y = element_text(size = 15)\n  )"
  },
  {
    "objectID": "week_12-5-2023.html#preliminaries",
    "href": "week_12-5-2023.html#preliminaries",
    "title": "2  Week of 12/5/2023",
    "section": "2.1 Preliminaries",
    "text": "2.1 Preliminaries\nFirst we load up the datasets for this week. Reading from GitHub using the TidyTuesday library wouldn’t work for me for some reason, so we read directly from GitHub.\n\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(rnaturalearth)\nlibrary(viridis)\nlibrary(leaflet)\nlibrary(RColorBrewer)\nlibrary(classInt)\nlibrary(knitr)\n\n# tuesdata <- tidytuesdayR::tt_load('2023-12-05')\n# life_expectancy <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-12-05/life_expectancy.csv')\n# life_expectancy_different_ages <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-12-05/life_expectancy_different_ages.csv')\n# life_expectancy_female_male <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-12-05/life_expectancy_female_male.csv')\nsetwd(\"data\")\n\nlife_expectancy <- read_csv('life_expectancy.csv')\nlife_expectancy_different_ages <- read_csv('life_expectancy_different_ages.csv')\nlife_expectancy_female_male <- read_csv('life_expectancy_female_male.csv')"
  },
  {
    "objectID": "week_12-5-2023.html#pivoting-data",
    "href": "week_12-5-2023.html#pivoting-data",
    "title": "2  Week of 12/5/2023",
    "section": "2.2 Pivoting Data",
    "text": "2.2 Pivoting Data\nIt looks like some countries have data that goes back pretty far, but all countries at least have data from 1950 to 2021. We’ll pivot the data into wide format and look at the change in Female/Male life expectancy difference.\n\ndata.wide <- life_expectancy_female_male %>% \n  filter(Year >= 1950) %>% \n  pivot_wider(names_from = Year, values_from = LifeExpectancyDiffFM) %>% \n  mutate(\"Relative Change in F/M Life Expectancy\" = `2021` - `1950`)\n\ndata.wide %>% head() %>% kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEntity\nCode\n1950\n1951\n1952\n1953\n1954\n1955\n1956\n1957\n1958\n1959\n1960\n1961\n1962\n1963\n1964\n1965\n1966\n1967\n1968\n1969\n1970\n1971\n1972\n1973\n1974\n1975\n1976\n1977\n1978\n1979\n1980\n1981\n1982\n1983\n1984\n1985\n1986\n1987\n1988\n1989\n1990\n1991\n1992\n1993\n1994\n1995\n1996\n1997\n1998\n1999\n2000\n2001\n2002\n2003\n2004\n2005\n2006\n2007\n2008\n2009\n2010\n2011\n2012\n2013\n2014\n2015\n2016\n2017\n2018\n2019\n2020\n2021\nRelative Change in F/M Life Expectancy\n\n\n\n\nAfghanistan\nAFG\n1.261900\n1.270601\n1.288300\n1.306601\n1.276501\n1.368801\n1.405600\n1.414700\n1.398800\n1.399300\n1.414600\n1.404202\n1.413601\n1.427002\n1.418198\n1.413200\n1.4580002\n1.4860992\n1.5021973\n1.495102\n1.5404968\n1.5822029\n1.618401\n1.615501\n1.604698\n1.588299\n1.591099\n1.551498\n2.663399\n3.828602\n3.921398\n3.983498\n5.621300\n5.861801\n8.181000\n8.420101\n6.520599\n6.713902\n4.996300\n4.718800\n4.688499\n4.791103\n5.250000\n2.522499\n4.013500\n3.048698\n3.084099\n2.998798\n3.684200\n2.889999\n3.096199\n3.072102\n2.445000\n2.618198\n2.558102\n2.683804\n3.109898\n3.567402\n3.357399\n3.072201\n3.130199\n3.167198\n3.196201\n3.235302\n3.462398\n3.816196\n3.902302\n5.994396\n6.534504\n6.057903\n5.565800\n6.364399\n5.102499\n\n\nAfrica (UN)\nNA\n2.402302\n2.428700\n2.466503\n2.482201\n2.742901\n2.781601\n2.870800\n2.901600\n2.937797\n2.989597\n3.229603\n3.337200\n3.080399\n3.012398\n3.048500\n3.076702\n3.0476990\n3.3866997\n3.3305970\n3.368202\n3.1548004\n3.0991020\n3.149601\n3.037998\n3.011601\n3.065399\n3.234299\n3.346001\n3.496700\n3.454399\n3.485802\n3.467102\n3.561699\n3.578301\n3.755901\n3.729401\n3.732498\n4.072002\n4.187302\n3.811398\n4.001400\n3.822800\n3.917301\n3.978901\n4.175899\n3.692101\n3.641602\n3.568199\n3.694401\n3.521900\n3.054199\n2.896301\n2.904499\n2.814796\n2.804401\n2.839703\n2.848599\n2.935200\n2.972801\n3.111099\n3.162602\n3.309902\n3.388104\n3.536499\n3.635300\n3.629997\n3.651203\n3.686100\n3.728401\n3.762001\n3.919903\n3.970898\n1.568596\n\n\nAlbania\nALB\n7.424797\n7.391701\n7.243599\n7.078999\n6.949303\n6.746403\n6.691898\n6.645100\n6.661400\n6.463501\n6.415199\n6.281799\n5.929600\n5.760101\n5.538799\n5.508099\n5.5183983\n5.2884980\n5.2436980\n5.135601\n4.9649963\n4.9142990\n4.876099\n4.638100\n4.523895\n4.493202\n4.410500\n4.388298\n4.461700\n4.476997\n4.938103\n5.157104\n5.436302\n5.595902\n5.705200\n5.749405\n5.780197\n5.879402\n6.153099\n6.223297\n6.383400\n6.309601\n6.311600\n6.160896\n6.055496\n6.082802\n6.077797\n6.542999\n5.831802\n5.807800\n5.772598\n5.696594\n5.602501\n5.558907\n5.450203\n5.460503\n5.442100\n5.147697\n5.266502\n5.228493\n5.195297\n5.104797\n4.972298\n4.994896\n4.898300\n4.778900\n4.737900\n4.631599\n4.571304\n4.497902\n5.043098\n5.085701\n-2.339096\n\n\nAlgeria\nDZA\n1.507400\n1.485001\n1.533802\n1.444698\n6.367199\n6.358700\n6.206299\n6.034500\n5.938999\n5.863201\n5.727600\n5.526501\n6.021301\n1.137798\n1.133198\n1.114498\n0.9798012\n0.9359016\n0.8544998\n0.891201\n0.9134979\n0.9510002\n1.050102\n1.017998\n1.367901\n1.399803\n1.544998\n1.834503\n2.006500\n2.266800\n2.646500\n2.964397\n3.365898\n3.452999\n3.165997\n3.168201\n3.450604\n2.799896\n1.866600\n2.037201\n2.203903\n2.629700\n3.069298\n2.938301\n3.548607\n4.028999\n3.265900\n3.435303\n3.518196\n2.711197\n2.881104\n2.698402\n2.616501\n1.905899\n2.077400\n2.006104\n2.065399\n2.235603\n2.229805\n2.451500\n2.103798\n2.195999\n2.507805\n2.409798\n2.663498\n2.367599\n2.109894\n2.121498\n2.238495\n2.522301\n2.830399\n3.080101\n1.572701\n\n\nAmerican Samoa\nASM\n3.789703\n3.546200\n3.492100\n4.285500\n3.241200\n3.104401\n3.136097\n3.292202\n3.130299\n3.318703\n3.752403\n5.343899\n5.718498\n6.029903\n5.709202\n5.535000\n1.6581001\n5.7038000\n5.9412956\n6.238697\n6.3439026\n6.3171997\n6.503403\n6.257301\n6.292603\n6.598602\n6.465996\n6.516106\n6.603897\n6.783798\n7.001900\n7.023399\n7.265701\n7.243301\n7.135002\n7.130897\n7.035599\n6.726898\n7.085602\n6.992996\n7.019600\n5.872604\n5.869293\n5.776001\n5.700501\n5.566399\n5.670303\n5.456703\n5.494202\n5.032501\n5.033302\n5.501198\n5.432900\n5.408195\n4.838806\n4.788101\n4.044601\n4.008095\n4.141800\n3.681602\n4.236603\n4.217796\n4.367500\n4.466293\n4.373398\n4.505302\n5.015404\n5.211502\n5.227402\n5.392403\n5.168106\n7.498901\n3.709198\n\n\nAndorra\nAND\n5.056801\n4.896900\n4.633499\n4.469398\n4.533699\n4.643700\n4.723297\n4.826004\n4.719704\n4.881203\n4.951500\n5.046600\n5.053001\n5.386299\n5.551201\n5.403099\n5.4696045\n5.5682983\n5.5493010\n5.620102\n5.5190964\n5.6990967\n5.455299\n5.594894\n5.705299\n5.971306\n6.011597\n6.061798\n6.210899\n6.312599\n6.291603\n6.386993\n6.382103\n6.306297\n6.675499\n6.655998\n6.610001\n6.802200\n6.894501\n7.184204\n7.396500\n6.893997\n3.749397\n5.746399\n1.690002\n5.208695\n4.984199\n3.465401\n6.680901\n4.030495\n3.483795\n6.583901\n3.957504\n5.270905\n2.018898\n3.722298\n2.739494\n5.063202\n5.032501\n4.981400\n4.950798\n4.920197\n4.889595\n4.859001\n4.828499\n4.787796\n4.747200\n4.716797\n4.686295\n4.655899\n7.429298\n7.151497\n2.094696"
  },
  {
    "objectID": "week_12-5-2023.html#static-world-map",
    "href": "week_12-5-2023.html#static-world-map",
    "title": "2  Week of 12/5/2023",
    "section": "2.3 Static World Map",
    "text": "2.3 Static World Map\nNow that all countries have a column with relative difference, lets plot the differences on a map. The values in the initial dataset represent a difference between female and male life expectancies in each year. The new column Relative Change in F/M Life Expectancy in the wider data is the change in life expectancy difference between females and males from 1950 to 2021. A negative value on the maps indicates a narrowing gap in life expectancy between females and males and a positive value indicates a widening gap.\n\nworld <- ne_countries(scale = \"small\", returnclass = \"sf\")\nworld <- left_join(world, data.wide, by = c(\"iso_a3_eh\" = \"Code\"))\n\n\np <- world %>% \n   \n  ggplot() + \n  theme_void() +\n  scale_fill_viridis_c(option = \"B\") +\n  geom_sf(aes(fill = `Relative Change in F/M Life Expectancy`),\n          color = NA) +\n  theme(legend.position = \"bottom\", \n        legend.key.width= unit(.5, \"in\"), # imperial metrics\n        legend.key.height = unit(.3, \"cm\"), # or normal\n        plot.background = element_rect(fill = \"white\", color = NA))\n\np"
  },
  {
    "objectID": "week_12-5-2023.html#interactive-world-map-leaflet",
    "href": "week_12-5-2023.html#interactive-world-map-leaflet",
    "title": "2  Week of 12/5/2023",
    "section": "2.4 Interactive World Map: leaflet",
    "text": "2.4 Interactive World Map: leaflet\nAs an exercise, I tried a few methods for making the map interactive and finally settled on the map below. Templates for how I created this map can be found here: (https://cengel.github.io/R-spatial/mapping.html)\n\nbreaks_qt <- classIntervals(world$`Relative Change in F/M Life Expectancy`, n = 7, style = \"quantile\")\npal_fun <- colorQuantile(\"YlOrRd\", NULL, n = 5)\n\np_popup <- paste0(\"<strong>Relative Change: </strong>\", world$`Relative Change in F/M Life Expectancy`, \"<br/>\", \"<strong>Country: </strong>\", world$Entity)\n\nleaflet(world) %>%\n  addPolygons(\n    stroke = FALSE, \n    fillColor = ~pal_fun(`Relative Change in F/M Life Expectancy`),\n    fillOpacity = 0.8, smoothFactor = 0.5,\n    popup = p_popup) %>%\n  addTiles() %>%\n  addLegend(\"bottomright\", \n            colors = brewer.pal(7, \"YlOrRd\"), \n            labels = paste0(\"up to \", format(breaks_qt$brks[-1], digits = 2)),\n            title =  'Changes in Female/Male Life Expectancy Gaps from 1950 to 2021') # legend title"
  },
  {
    "objectID": "week_1-9-2024.html#preliminaries",
    "href": "week_1-9-2024.html#preliminaries",
    "title": "3  Week of 1/9/2024",
    "section": "3.1 Preliminaries",
    "text": "3.1 Preliminaries\nFirst we load up the datasets for this week.\n\nlibrary(tidyverse)\nlibrary(viridis)\nlibrary(lubridate)\n\n# tuesdata <- tidytuesdayR::tt_load('2024-01-09')\n\nIn the discussion of the dataset the first chapter of (https://www.amazon.com/Outliers-Story-Success-Malcolm-Gladwell/dp/0316017930)[Malcolm Gladwell’s Outliers] is brought up and it’s mentioned that in Canadian Junior Hockey there is a higher likelihood for players to be born in the first quarter of the year. We are given data on NHL players and their teams as well as data on births in Canada from 1991 to 2002. Before diving into the NHL data, let’s look at how births are distributed by quarter year over year.\n\nsetwd('data')\ncanada_births_1991_2022 <- read_csv('canada_births_1991_2022.csv')\nnhl_player_births <- read_csv('nhl_player_births.csv')\nnhl_rosters <- read_csv('nhl_rosters.csv')\nnhl_teams <- read_csv('nhl_teams.csv')\n\n\n# put the months for canada births into quarters\ncanada_births_1991_2022 <- canada_births_1991_2022 %>% \n  mutate(quarter = quarter(month), year_quarter = paste0(year, \"-\", quarter))\n\n\n# plot the canada births over time to see trends\ncanada_births_1991_2022 %>% \n  group_by(year_quarter) %>% \n  summarise(total_births = sum(births)*.01) %>% \n  ggplot(aes(x = year_quarter, y = total_births)) + \n  geom_bar(stat = \"identity\") +\n  theme(axis.text.x = element_text(angle = 90, size = 3))\n\n\n\n\nIt seems like the births in Canada overall seem to peak in the second quarter of each year. I’ll contrast this with the births from the NHL birth dataset.\n\n# similar to above, create a year and quarter variable to contrast with \n# canada births\nnhl_player_births <- nhl_player_births %>% \n  mutate(quarter = quarter(birth_month), year_quarter = paste0(birth_year, \"-\", quarter))\n\n\nnhl_player_births %>% \n  filter(birth_year > 1980) %>% \n  group_by(year_quarter) %>%\n  summarise(sum_births = n()) %>% \n  ggplot(aes(x = year_quarter, y = sum_births)) + \n  geom_bar(stat = \"identity\") +\n  theme(axis.text.x = element_text(angle = 90, size = 3)) \n\n\n\n\nThis certainly seems to show a trend that the first quarter of each year has the highest amount of births. I’m going to make a heatmap to see by month and year how the births look. For this data, I’ll constrain it to births from 1954 to 2004 to trim the dataset a bit and make it slightly more relevant to NHL today.\n\n#Assign color variables\ncol1 = \"white\" \ncol2 = \"#272770\"\n\nnhl_player_births %>% \n  # mutate(birth_month = month(birth_month, label = TRUE)) %>% \n  filter(birth_year > 1953 & birth_year < 2005) %>% \n  group_by(birth_year, quarter) %>% \n  summarise(N = n()) %>% \n  ggplot(aes(birth_year, quarter)) + geom_tile(aes(fill = N),colour = \"white\") +\n  scale_fill_gradient(low = col1, high = col2) +  \n  guides(fill=guide_legend(title=\"Total Births\")) +\n  labs(title = \"NHL Player Birth Heatmap\",\n       x = \"Birth Year\", y = \"Birth Quarter\") +\n  theme_bw() + theme_minimal()"
  }
]